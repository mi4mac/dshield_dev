{
    "name": "dshield_dev",
    "version": "1.1.0",
    "label": "DShield",
    "description": "Provide investigative actions like lookup ip, get threat feeds, top ports, daily summary, and top attacking IPs from DShield",
    "publisher": "FortiSOAR Community",
    "icon_small_name": "DShield_small.png",
    "icon_large_name": "DShield_large.png",
    "category": "Information",
    "configuration": {
        "fields": [
            {
                "title": "Server URL",
                "name": "server_url",
                "type": "text",
                "visible": true,
                "editable": true,
                "required": true,
                "value": "https://www.dshield.org",
                "description": "DShield server URL (e.g., https://www.dshield.org)"
            },
            {
                "title": "API Key",
                "name": "api_key",
                "type": "password",
                "visible": true,
                "editable": true,
                "required": false,
                "value": "",
                "description": "DShield API key for authentication (optional for public endpoints)"
            },
            {
                "title": "Request Timeout",
                "name": "timeout",
                "type": "number",
                "visible": true,
                "editable": true,
                "required": false,
                "value": 30,
                "description": "Request timeout in seconds (default: 30)"
            }
        ]
    },
    "operations": [
        {
            "operation": "lookup_ip",
            "category": "investigation",
            "annotation": "lookup_ip",
            "description": "Get details about an IP Address from DShield",
            "title": "Lookup IP",
            "parameters": [
                {
                    "title": "IP Address",
                    "name": "ip",
                    "value": "",
                    "type": "text",
                    "visible": true,
                    "editable": true,
                    "required": true
                }
            ],
            "output_schema": {
                "ip": {
                    "mindate": "",
                    "count": "",
                    "network": "",
                    "attacks": "",
                    "asname": "",
                    "asabusecontact": "",
                    "comment": "",
                    "as": "",
                    "number": "",
                    "maxrisk": "",
                    "assize": "",
                    "maxdate": "",
                    "ascountry": "",
                    "updated": "",
                    "alexa": {
                        "lastrank": "",
                        "firstseen": "",
                        "lastseen": "",
                        "hostname": "",
                        "domains": ""
                    },
                    "threatfeeds": {
                        "forumspam": {
                            "firstseen": "",
                            "lastseen": ""
                        },
                        "qakbot": {
                            "firstseen": "",
                            "lastseen": ""
                        }
                    }
                }
            },
            "enabled": true
        },
        {
            "operation": "get_threat_feeds",
            "category": "investigation",
            "annotation": "get_threat_feeds",
            "description": "Get open threat feeds from DShield",
            "title": "Get Threat Feeds",
            "parameters": [
                {}
            ],
            "output_schema": [
                {
                    "name": "",
                    "description": "",
                    "datatype": "",
                    "frequency": "",
                    "type": "",
                    "lastupdate": ""
                }
            ],
            "enabled": true
        },
        {
            "operation": "get_top_ports",
            "category": "investigation",
            "annotation": "get_top_ports",
            "description": "Get top ports information from DShield",
            "title": "Get Top Ports",
            "parameters": [
                {}
            ],
            "output_schema": {
                "ports": [
                    {
                        "port": "",
                        "count": "",
                        "percentage": ""
                    }
                ]
            },
            "enabled": true
        },
        {
            "operation": "get_daily_summary",
            "category": "investigation",
            "annotation": "get_daily_summary",
            "description": "Get daily summary from DShield for the last 7 days",
            "title": "Get Daily Summary",
            "parameters": [
                {}
            ],
            "output_schema": {
                "daily_summaries": [
                    {
                        "date": "Date of the summary",
                        "records": "Number of attack records",
                        "sources": "Number of source IPs",
                        "targets": "Number of target IPs"
                    }
                ],
                "summary_totals": {
                    "total_records": "Total attack records for the period",
                    "total_sources": "Total source IPs for the period",
                    "total_targets": "Total target IPs for the period",
                    "date_range": "Date range for the summary data"
                },
                "summary_type": "Parsed XML",
                "_metadata": {
                    "source": "DShield",
                    "connector_version": "1.1.0",
                    "endpoint": "dailysummary",
                    "note": "Parsed XML format daily summary data"
                }
            },
            "enabled": true
        },
        {
            "operation": "get_top_attacking_ips",
            "category": "investigation",
            "annotation": "get_top_attacking_ips",
            "description": "Get top attacking IPs from DShield",
            "title": "Get Top Attacking IPs",
            "parameters": [
                {}
            ],
            "output_schema": {
                "ips": [
                    {
                        "ip": "",
                        "count": "",
                        "country": "",
                        "asn": ""
                    }
                ]
            },
            "enabled": true
        }
    ],
    "cs_compatible": true,
    "help_online": "https://www.dshield.org/help.html"
}